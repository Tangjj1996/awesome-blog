# çµæ´»è¿ç”¨js ---æŠ€å·§ç¯‡

## 1. æ¡ä»¶åˆ¤æ–­

ç¼–å†™jsä»£ç è¿‡ç¨‹ä¸­ï¼Œå°‘ä¸äº†é€»è¾‘åˆ¤æ–­ï¼Œé€šå¸¸éƒ½æ˜¯`if/else`æˆ–è€…`switch`ã€‚ä½†æ˜¯åœ¨é€»è¾‘å¤æ‚çš„æ—¶å€™ï¼Œæ€»æ˜¯ä¼šæŠŠæ¡ä»¶åˆ¤æ–­è¯­å¥å†™çš„å¾ˆé•¿ï¼Œè¶Šæ¥è¶Šè‡ƒè‚¿ï¼Œéš¾ä»¥é˜…è¯»ã€‚

æ¯”å¦‚

```js
const onBtn = (state) => {
    if (state === 1) {
        gotoPage('success')
    } else if (state === 2)  {
        gotoPage('fail')
    } else if (state === 3) {
        gotoPage('warning')
    } else if (state === 4) {
        gotoPage('loading')
    } else {
        gotoPage('cancel')
    }
}
```
ä¹Ÿè®¸ä½ ä¼šæƒ³åˆ°æŠŠä¸Šè¿°çš„æ¡ä»¶åˆ¤æ–­ä½¿ç”¨`switch`æ”¹å†™ï¼Œçš„ç¡®ç”¨`switch`ä¼šæ¯”`if/else`ç¨å¾®ç®€ä»‹ä¸€äº›ï¼Œä½†é¢å¯¹æ›´å¤æ‚çš„é€»è¾‘ä¹Ÿæ˜¯å¾ˆå±€é™çš„ã€‚æ‰€ä»¥å‘¢ï¼Œæˆ‘ä»¬å¯ä»¥æ¢ä¸€ç§æ€è·¯ï¼ŒæŠŠè¿™äº›æ¡ä»¶å’Œå¯¹åº”çš„é€»è¾‘ä¿å­˜åœ¨ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œå†æ ¹æ®å®žé™…è°ƒç”¨æ‰§è¡Œ

```js
const stateObj = {
    '1': ['success'],
    '2': ['fail'],
    '3': ['warning'],
    '4': ['loading'],
    'default': ['cancel']
}

const onBtn = (state) => {
    const action = stateObj[state] || stateObj['default']

    gotoPage(action[0])
}
```

å¯ä»¥çœ‹åˆ°ï¼ŒæŠŠé€»è¾‘ä¿å­˜åœ¨ä¸€ä¸ªå¯¹è±¡ä¸­æ˜¯ä¼šæ¯”ä¸æ–­`if/else`æˆ–è€…`switch`è¦ç®€æ´ä¸€ç‚¹ï¼Œä½†ç”¨æ•°å€¼å­—ç¬¦ä¸²ä½œä¸ºå¯¹è±¡çš„é”®æ€»æ˜¯è®©äººè§‰å¾—å¥‡æ€ªï¼Œæ‰€ä»¥å‘¢ï¼Œå†æ­¤åŸºç¡€ä¸Šè¿›è¡Œå†æ¬¡ä¼˜åŒ–ã€‚

es6ä¸­å¼•å…¥äº†ä¸¤ç§æ–°çš„æ•°æ®ç»“æž„ï¼Œä¸€ç§å«`Set`ï¼Œç”¨æ¥å­˜å‚¨ä¸é‡å¤çš„å…ƒç´ ï¼Œå¦ä¸€ç§å«`Map`ï¼Œå¯¹è±¡çš„æ•°æ®ç»“æž„æ˜¯`é”®-å€¼`ï¼Œä¹Ÿå°±æ˜¯åªæœ‰å­—ç¬¦ä¸²æˆ–è€…`symbol`æ‰èƒ½ä½œä¸ºé”®å€¼ï¼Œè¿™ç»™å¯¹è±¡å¸¦æ¥äº†å¾ˆå¤§çš„å±€é™æ€§ï¼Œæ¯•ç«Ÿæœ‰å¾ˆå¤šæ—¶å€™æˆ‘ä»¬å¸Œæœ›`å€¼-å€¼`çš„å­˜å‚¨æ–¹å¼ï¼Œè€Œ`Map`å°±å¾ˆå¥½åœ°è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚

åˆ©ç”¨Mapç»“æž„æ¥è¿›è¡Œä¼˜åŒ–

```js
const stateMap = new Map([
    [1, 'success'],
    [2, 'fail'],
    [3, 'warning'],
    [4, 'loading'],
    ['default', 'cancel']
])

const onBtn = (state) => {
    const action = stateMap.get(state) || stateMap.get('default')
    
    gotoPage(action[0])
}
```

è¿™æ ·çœ‹èµ·æ¥å°±å¥½å¤šäº†ï¼Œå½“ç„¶å®žé™…æƒ…å†µå¯èƒ½æ˜¯å¤šå˜çš„ï¼Œæ¯ä¸€ä¸ª`state`å¯èƒ½éƒ½å¯¹åº”ç€ä¸åŒçš„å‡½æ•°ï¼Œè¿™æ—¶å€™å¯ä»¥ç›´æŽ¥æŠŠå‡½æ•°ä¿å­˜åœ¨`Map`ä¸­

```js
const stateMap = new Map([
    [1, () => {}],
    [2, () => {}],
    [3, () => {}],
    [4, () => {}],
    ['default', () => {}],
])

const onBtn = (state) =>  {
    const action = stateMap.get(state) || stateMap.get('default')
    
    action.call(this)
}
```

ä¸šåŠ¡ä»£ç ä¸­ç»å¸¸ä¼šåŠ å…¥èº«ä»½`identity`å’Œ`state`è”åˆåˆ¤æ–­ï¼ŒæŒ‰ç…§ä¸Šè¿°çš„æ€æƒ³ï¼ŒæŠŠæ‰€æœ‰åˆ¤æ–­æ¡ä»¶éƒ½å‚¨å­˜åˆ°`Map`

```js
const actionsMap = new Map([
    [{identity: 'guest', state: 1}, () => {}],
    [{identity: 'guest', state: 2}, () => {}],
    [{identity: 'guest', state: 3}, () => {}],
    [{identity: 'guest', state: 4}, () => {}],
])

const onBtn = (identity, state) {
    const action = [...actionsMap].filter(([key, value]) => key.identity === identity && key.state === state)
    
    action.forEach(([key, vlaue]) => value.call(this))
}
```

ç»“åˆæ­£åˆ™ï¼Œå¯ä»¥å†™çš„æ›´é«˜çº§ä¸€äº›ï¼Œå‡å¦‚`state`**1-3**éƒ½æ˜¯ä¸€æ ·çš„æ‰§è¡Œå‡½æ•°

```js
const actions = () => {
    const functionA = () => {}
    const functionB = () => {}
    
    return new Map([
        [/guest_[1-3]/, functionA],
        [/guest_4/, functionB]
    ])
}

const onBtn = (identity, state) => {
    const action = [...actions].filter(([key, value]) => key.test(`${identity}_${state}`))
    
    action.forEach(([key, value]) => value.call(this))
}
```

`Map`æ•°æ®ç»“æž„ç»™jså¢žåŠ äº†æ›´å¤šçš„å¯èƒ½æ€§ï¼Œä»¥åŽå†™é€»è¾‘åˆ¤æ–­å¯åƒä¸‡åˆ«åªä¼š`if/else`æˆ–è€…`switch`äº†ï¼Œæ€è·¯å¼€é˜”ä¸€äº›èƒ½è®©ä»£ç å˜å¾—æ›´ç®€æ´ï¼ŒðŸ˜„

## 2. æ ‘èŠ‚ç‚¹éåŽ†

å¤æ‚ç»„ä»¶æ¯”å¦‚`element-ui`ä¸­çš„`tree`ç»„ä»¶å°‘ä¸äº†è¦åŽ»éåŽ†æ ‘èŠ‚ç‚¹ï¼Œæ ¹æ®éåŽ†æƒ…å†µè§¦å‘ç›¸åº”çš„è§„åˆ™ï¼Œå¯ä»¥è¯´éåŽ†ç®—æ³•åœ¨å‰ç«¯å¼€å‘ä¸­çš„åœ°ä½ä¸ä½ŽäºŽæŽ’åºç®—æ³•ï¼Œæ‰€ä»¥ç‰¹æ„æ€»ç»“ä»¥ä¸‹å¼€å‘ä¸­å¸¸è§çš„å‡ ç§éåŽ†æ€è·¯ã€‚

éåŽ†åˆ†ä¸ºå¹¿åº¦ä¼˜å…ˆéåŽ†å’Œæ·±åº¦ä¼˜å…ˆéåŽ†ï¼Œæ·±åº¦ä¼˜å…ˆä¸€èˆ¬é€’å½’å®žçŽ°ï¼Œä½¿ç”¨é¢‘çŽ‡é«˜ï¼Œå¹¿åº¦ä¼˜å…ˆéåŽ†ä¸€èˆ¬å¾ªçŽ¯å®žçŽ°ï¼Œä½¿ç”¨é¢‘çŽ‡ä½Žã€‚åŒæ—¶æ·±åº¦ä¼˜å…ˆéåŽ†åˆå¯ä»¥åˆ†ä¸ºå…ˆåºéåŽ†å’ŒåŽåºéåŽ†ã€‚

æ·±åº¦ä¼˜å…ˆå’Œå¹¿åº¦ä¼˜å…ˆç®€è¦æ¦‚å¿µ
- æ·±åº¦ä¼˜å…ˆï¼š è®¿é—®åŒçº§å­èŠ‚ç‚¹ï¼Œå†åŽ»è®¿é—®ä¸‹ä¸€çº§çš„å­èŠ‚ç‚¹ï¼Œä¸€ç›´è®¿é—®åˆ°å†ä¹Ÿæ²¡æœ‰ä¸‹ä¸€çº§å­èŠ‚ç‚¹å†æŒ‰ç…§ç›¸åŒçš„è®¿é—®è§„åˆ™åŽ»è®¿é—®åŒçº§çš„å­èŠ‚ç‚¹ã€‚å…ˆè®¿é—®æ ¹èŠ‚ç‚¹å†è®¿é—®å­èŠ‚ç‚¹çš„å«å…ˆåºéåŽ†ï¼Œå…ˆè®¿é—®å­èŠ‚ç‚¹æœ€åŽåˆ°æ ¹çš„å«åŽåºéåŽ†ã€‚

- å¹¿åº¦ä¼˜å…ˆï¼š æŒ‰ç…§**åŒçº§é¡ºåº**ï¼Œå¦‚æžœè¦è®¿é—®n+1ï¼Œé¦–å…ˆè®¿é—®nï¼Œè€Œä¸ç”¨ç®¡nå†…çš„å­èŠ‚ç‚¹ã€‚

å‡è®¾æœ‰ä¸€ä¸ªæ ‘èŠ‚ç‚¹

```js
let tree = [
    {
        id: 1,
        title: 'èŠ‚ç‚¹1',
        children: [
            {
                id: 2,
                title: 'èŠ‚ç‚¹1-1'
            }
        ]
    },
    {
        id: 3,
        title: 'èŠ‚ç‚¹2'
    },
    {
        id: 4,
        title: 'èŠ‚ç‚¹3',
        children: [
            {
                id: 5,
                title: 'èŠ‚ç‚¹3-1'
            },
            {
                id: 6,
                title: 'èŠ‚ç‚¹3-2'
            }
        ]
    }    
]
```
å¹¿åº¦ä¼˜å…ˆ

```js
// å¹¿åº¦ä¼˜å…ˆ
function seniorGround (propTree, func) {
    // node ä¿å­˜æ•°ç»„ç¬¬ä¸€é¡¹æ•°æ®ï¼Œ listä¸ºæ ‘èŠ‚ç‚¹çš„æ‹·è´æ•°ç»„
    let node, list = [...propTree]  

    while(node = list.shift()) {
        func(node.title) 
        // å½“æœ‰å­èŠ‚ç‚¹ï¼Œå…ˆè¾“å‡ºåŒçº§èŠ‚ç‚¹titleï¼ŒæŠŠå­èŠ‚ç‚¹æ”¾è¿›æ•°ç»„æœ€åŽä¸€é¡¹ï¼Œä¸€ç›´åˆ°listä¸ºç©º
        node.children && list.push(...node.children)
    }
}

seniorGround(tree, node => console.log(node))
```

æŽ§åˆ¶å°è¾“å‡º
```sh
èŠ‚ç‚¹1
èŠ‚ç‚¹2
èŠ‚ç‚¹3
èŠ‚ç‚¹1-1
èŠ‚ç‚¹3-1
èŠ‚ç‚¹3-2
```

æ·±åº¦ä¼˜å…ˆ(å…ˆåºéåŽ†)

```js
// æ·±åº¦å…ˆåº
function deepSequence (propTree, func) {
    propTree.forEach(node => {
        func(node.title)
        node.children && deepSequence(node.children, func)
    })
}

deepSequence(tree, node => console.log(node))
```

æ·±åº¦ä¼˜å…ˆ(åŽåºéåŽ†)

```js
// æ·±åº¦åŽåº  
// æ·±åº¦åŽåºå’Œå…ˆåºæ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯å‡½æ•°å‚æ•°çš„æ‰§è¡Œé¡ºåºæœ‰æ‰€åŒºåˆ«
// å…ˆåºæ˜¯è®¿é—®åˆ°å­èŠ‚ç‚¹å°±å…ˆæ‰§è¡Œå‡½æ•°ï¼Œå†åŽ»é€’å½’
// åŽåºæ˜¯å…ˆé€’å½’ï¼Œå½“åˆ°è¾¾é€’å½’æ ˆé¡¶å†æ‰§è¡Œå‡½æ•°ï¼Œæ­¤æ—¶çš„èŠ‚ç‚¹å°±åœ¨æœ€æ·±ä¸€çº§

function deepReverse (propTree, func) {
    propTree.forEach(node => {
        node.children && deepSequence(node.children, func)
        func(node.title)
    })
}

deepReverse(tree, node => console.log(node))
```

é€’å½’éåŽ†æ˜¯æœ€å¸¸è§çš„ç®—æ³•ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç”¨å¾ªçŽ¯,åƒå¹¿åº¦éåŽ†ä¸€æ ·ç»´æŠ¤ä¸€ä¸ªé˜Ÿåˆ—

```js
// æ·±åº¦å…ˆåº,å¾ªçŽ¯å®žçŽ°
// æ€è·¯å°±æ˜¯è®¿é—®åˆ°èŠ‚ç‚¹ï¼ŒæŠŠå®ƒå­èŠ‚ç‚¹æ”¾åˆ°é˜Ÿåˆ—çš„é¡¶éƒ¨
// funcçš„å‚æ•°æ€»æ˜¯æœ€æ·±åº¦çš„å­èŠ‚ç‚¹ï¼Œç„¶åŽæ‰æ˜¯åŒçº§èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹(next brother)

function deepSequence (propTree, func) {
    let node, list = [...propTree]

    while(node = list.shift()) {
        func(node.title)

        node.children && list.unshift(...node.children)
    }
}

deepSequence(tree, node => console.log(node))
```

